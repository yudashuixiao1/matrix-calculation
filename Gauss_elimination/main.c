// The Gauss elimination method
// for solving a system of linear equations
//     Ax = b
//
#include <stdio.h>
//#include <math.h>
#define NMAT 11


void gauss_elimination(double a[NMAT][NMAT], double b[NMAT], double x[NMAT]);

void gauss_elimination(double a[NMAT][NMAT], double b[NMAT], double x[NMAT]) {
	int n = NMAT;
	int i,j,k;

	for (i = 0; i < n; i++) {

		for (j = i+1; j < n; j++) {
		  	a[i][j] = a[i][j] / a[i][i];
		}
		b[i] = b[i] / a[i][i];

		for (j = i+1; j < n; j++) {
			double factor = a[j][i];
			for (k = i; k < n; k++) {
				a[j][k] = a[j][k] - a[i][k] * factor;
			}
			b[j] = b[j] - factor * b[i];
		}
	}


	for (i = n-1; i >= 0; i--) {
		x[i] = b[i];
		for(j = i+1; j < n; j++) {
			x[i] -= a[i][j] * x[j];
		}
	}
}

// -------------------------------------------------------
//


int main(){


double a[11][11] =
{{0.00583690322580645,-0.00422400000000000,0,0,0,0,0,0,0,0,0},
{-0.00422400000000000,0.00522400000000000,-0.00100000000000000,0,0,0,0,0,0,0,0},
{0,-0.00100000000000000,0.00399111111111111,-0.000111111111111111,0,-0.00288000000000000,0,0,0,0,0},
{0,0,-0.000111111111111111,0.00433511111111111,-0.00422400000000000,0,0,0,0,0,0},
{0,0,0,-0.00422400000000000,0.00583690322580645,0,0,0,0,0,-0.00161290322580645},
{0,0,0,0,-0.00161290322580645,9999999.99990976,0,0,0,-0.000161290322580645,0.00186443354838710},
{0,0,0,0,0,0,0.0291869313482217,-0.000200000000000000,-0.0288000000000000,0,0},
{0,0,0,0,0,-8.33333333333333e-05,-0.000200000000000000,0.00222555555555556,-0.00192000000000000,-2.22222222222222e-05,0},
{0,0,0,0,0,0,-0.0288000000000000,-0.00192000000000000,0.0596033333333333,-0.0288000000000000,0},
{0,0,0,0,0,0,0,-2.22222222222222e-05,-0.0288000000000000,0.0289835125448029,-0.000161290322580645},
{0,0,-0.00288000000000000,0,0,0.00305357433333333,0,-8.33333333333333e-05,0,0,-9.02400000000000e-05}};

double b[11] = {-0.00106884424213353, -0.000348692601884063, 0.000174265198850949, 0.000174427403041040, -0.000174427403041040, -0.000149429667406232, 2.41146505716419e-05, 2.42126805918570e-05, 2.52775723989535e-05, -0.000215358587964216, -2.48355314447163e-05};
double x[11] ;

//gauss_elimination(10, aa, bb, x);

gauss_elimination( a,  b,  x);

	//printf("solution x:\n");
	for (int i=0; i<NMAT; i++) {
		printf("%e\n ", x[i]);
	//	if (i%5==0) printf("\n");
	}

	return 0;
}
